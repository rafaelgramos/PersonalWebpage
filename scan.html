<head>
  <link rel="stylesheet" type = "text/css" href = "scan_app.css"/>
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.8.0/dist/leaflet.css" integrity="sha512-hoalWLoI8r4UszCkZ5kL8vayOGVae1oxXe/2A4AO6J9+580uKHDO3JdHb7NzwwzK5xr/Fs0W40kiNHxM9vyTtQ==" crossorigin=""/>
    <script src="https://unpkg.com/leaflet@1.8.0/dist/leaflet.js" integrity="sha512-BB3hKbKWOc9Ez/TAwyWxNXeoV9c1v6FIeYiBieIWkpLjauysF18NzgR1MBNBXf8/KABdlkX68nAhlwcDFLGPCQ==" crossorigin=""></script>

</head>
<body>
  <div id="map" style="width: 600px; height: 400px;"></div>
  <script>
  
    //location_coords = c("sao_jose_dos_campos_sp" = c(-45.8869400,-23.1794400),#c(-43.50044,-20.38571)
    //                "campinas_sp" = c(-47.0616,-22.9064))
  	var map,tiles,my_marker;
  	var my_icon = L.icon({
      iconUrl: 'icon2.png',
      iconSize:     [20, 20],
      className: 'blinking'
    });
  	
  	
  	function onError (err) {
    }
    
    function onSuccess (position) {
      var coords = position.coords;
      
      if(typeof map == "undefined") {
        map = L.map('map').setView([coords.latitude, coords.longitude], 13);
        tiles = L.tileLayer('https://api.mapbox.com/styles/v1/{id}/tiles/{z}/{x}/{y}?access_token=pk.eyJ1IjoibWFwYm94IiwiYSI6ImNpejY4NXVycTA2emYycXBndHRqcmZ3N3gifQ.rJcFIG214AriISLbB6B5aw', {
  		  maxZoom: 18,
  		  attribution: 'Map data &copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors, ' +
  			'Imagery Â© <a href="https://www.mapbox.com/">Mapbox</a>',
  		  id: 'mapbox/streets-v11',
  		  tileSize: 512,
  		  zoomOffset: -1
  	    }).addTo(map);
  	    my_marker = new L.marker([coords.latitude,coords.longitude], {icon : my_icon});
  	    my_marker.addTo(map);
      }
      else {
        my_marker.setLatLng([coords.latitude,coords.longitude]);
      }
      //if(typeof my_marker == "undefined") {
      //  my_marker = 0;
      //}
    }
  	//var marker = L.marker([-23.1794400,-45.8869400]).addTo(map)
    
    navigator.geolocation.getCurrentPosition(onSuccess, onError);
  	setInterval(function () {
        navigator.geolocation.getCurrentPosition(onSuccess, onError);
    }, 1000)
  
  </script>


</body>